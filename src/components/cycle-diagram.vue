<template>
  <svg class="svg-wrapper" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="602px" height="122px" viewBox="-0.5 -0.5 602 122" content="&lt;mxfile host=&quot;app.diagrams.net&quot; modified=&quot;2020-04-25T13:30:56.927Z&quot; agent=&quot;5.0 (Macintosh)&quot; etag=&quot;BA7Qah0DVFev6VasY-zT&quot; version=&quot;13.0.1&quot; type=&quot;device&quot;&gt;&lt;diagram id=&quot;bvhBq9FN3oEnQMqCWVct&quot; name=&quot;Page-1&quot;&gt;3ZdNj9owEIZ/DcdW+d7tkQW2lbrVSuVQerTIkLjrZFIzgdBfXzuZkETRUiqtStQL8rz2xPY78xCY+Yus+qhFkX7BGNTMc+Jq5i9nnheFnvm0wqkRguBDIyRaxo3kdsJa/gIWHVZLGcN+sJAQFcliKG4xz2FLA01ojcfhsh2q4a6FSGAkrLdCjdVvMqa0Ue9Dp9M/gUzSdmfX4ZlMtItZ2KcixmNP8lczf6ERqRll1QKU9a71pcl7fGX2fDANOV2T8BJkG+fzz6WzeMqfo7uvzoM/f+fe8eHo1N4YYmMAh6gpxQRzoVad+qCxzGOwj3VM1K15QiyM6BrxBxCduJqiJDRSSpniWagkbXrj7/ZR70OOlhU/uQ5ObZCTPm36QS/Lhl1aHbV5e9L4cq6dX8/Hc9sZ9n4HoRrlUar2dI0j1oZXnWZpj6XewiV7fW5ZoROgSwuDc0cYkgAzMHcwiRqUIHkYnkRwTyfndV3ZzYAr/zddwMc0bpS81UKDIFPjUXcoZdCzXXBMJcG6ELUBRwP/sMZiXzQ87mRle4VtPYAmqC4bO7aBE7wWLv4ycSOOjz00WUp7VLbamxt3Zvu/xedPsIzxekt8gmvxCW+KTzDCZx7bCtt3lX03Sb0t7UEwnxZPfjQ1ntyxQVPl6ZZchNdyEd2Ui3DExXMBugbBWDYpFEJvYig0pRuaV5IRcGdtA32Qxp5JeRjd/zMPTdj9cq7nen8//NVv&lt;/diagram&gt;&lt;/mxfile&gt;">
     <defs />
     <g>
        <path d="M 94 54 L 171 54" :class="itemOneClass" fill="none" stroke="#000000" stroke-width="3" stroke-miterlimit="10" pointer-events="stroke" />
        <ellipse :class="itemOneClass" cx="174" cy="54" rx="3" ry="3" stroke-width="3" pointer-events="all" />
        <ellipse cx="54" cy="54" rx="40" ry="40" class="svg-ellipse grey-stroke" pointer-events="all" />
        <g transform="translate(-0.5 -0.5)">
           <switch>
              <foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility">
                 <div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 78px; height: 1px; padding-top: 54px; margin-left: 15px;">
                    <div style="box-sizing: border-box; font-size: 0; text-align: center; ">
                       <div style="display: inline-block; font-size: 16px; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Test</div>
                    </div>
                 </div>
              </foreignObject>
              <text x="54" y="58" fill="#000000" font-size="12px" text-anchor="middle">Created</text>
           </switch>
        </g>
        <path d="M 254 54 L 331 54" :class="itemTwoClass" fill="none" stroke="#000000" stroke-width="3" stroke-miterlimit="10" pointer-events="stroke" />
        <ellipse :class="itemTwoClass" cx="334" cy="54" rx="3" ry="3" stroke-width="3" pointer-events="all" />
        <ellipse cx="214" cy="54" rx="40" ry="40" class="svg-ellipse grey-stroke" pointer-events="all" />
        <g transform="translate(-0.5 -0.5)">
           <switch>
              <foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility">
                 <div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 78px; height: 1px; padding-top: 54px; margin-left: 175px;">
                    <div style="box-sizing: border-box; font-size: 0; text-align: center; ">
                       <div style="display: inline-block; font-size: 16px; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Test</div>
                    </div>
                 </div>
              </foreignObject>
              <text x="214" y="58" fill="#000000" font-size="12px" text-anchor="middle">Added to circ...</text>
           </switch>
        </g>
        <path d="M 414 54 L 491 54" :class="itemThreeClass" fill="none" stroke="#000000" stroke-width="3" stroke-miterlimit="10" pointer-events="stroke" />
        <ellipse :class="itemThreeClass" cx="494" cy="54" rx="3" ry="3" fill="#000000" stroke="#000000" stroke-width="3" pointer-events="all" />
        <ellipse cx="374" cy="54" rx="40" ry="40" class="svg-ellipse grey-stroke" pointer-events="all" />
        <g transform="translate(-0.5 -0.5)">
           <switch>
              <foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility">
                 <div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 78px; height: 1px; padding-top: 54px; margin-left: 335px;">
                    <div style="box-sizing: border-box; font-size: 0; text-align: center; ">
                       <div style="display: inline-block; font-size: 16px; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Test</div>
                    </div>
                 </div>
              </foreignObject>
              <text x="374" y="58" fill="#000000" font-size="12px" text-anchor="middle">Operational</text>
           </switch>
        </g>
        <ellipse cx="534" cy="54" rx="40" ry="40" class="svg-ellipse grey-stroke" pointer-events="all" />
        <g transform="translate(-0.5 -0.5)">
           <switch>
              <foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility">
                 <div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 78px; height: 1px; padding-top: 54px; margin-left: 495px;">
                    <div style="box-sizing: border-box; font-size: 0; text-align: center; ">
                       <div style="display: inline-block; font-size: 16px; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Test</div>
                    </div>
                 </div>
              </foreignObject>
              <text x="534" y="58" fill="#000000" font-size="12px" text-anchor="middle">Out of service</text>
           </switch>
        </g>
     </g>
     <switch>
        <g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" />
        <a transform="translate(0,-5)" xlink:href="https://desk.draw.io/support/solutions/articles/16000042487" target="_blank">
           <text text-anchor="middle" font-size="10px" x="50%" y="100%">Viewer does not support full SVG 1.1</text>
        </a>
     </switch>
  </svg>
</template>

<script>
import { EventBus } from '../main.js';

export default {
  name: 'CycleDiagram',
  data: function() {
    return {
      'lookingAt': null
    }
  },
  computed: {
    itemOneClass() {
      console.log("Computing item1class");
      return {
        'green-stroke': true,
        'pulsing-colour': "item1" == this.lookingAt
      }
    },
    itemTwoClass() {
      console.log("Computing item2class");
      return {
        'yellow-stroke': true,
        'pulsing-colour': "item2" == this.lookingAt
      }
    },
    itemThreeClass() {
      console.log("Computing item3class");
      return {
        'red-stroke': true,
        'pulsing-colour': "item3" == this.lookingAt
      }
    }
  },
  mounted() {
    EventBus.$on('lookingAt', function(payload) {
      console.log("Focusing on ", payload);
      this.lookingAt = payload;
      this.$forceUpdate();
    }.bind(this))
    EventBus.$on('notLookingAt', function(payload) {
      console.log("No longer focusing on ", payload);
      this.lookingAt = null;
    }.bind(this))
  },
  //beforeUnmount() {
  //  EventBus.$off('lookingAt');
  //}
}
</script>
